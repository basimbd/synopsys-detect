name: Release-QA Workflow

on: workflow_dispatch

jobs:
  remove-snapshot:
    runs-on: [ self-hosted, linux ]
    permissions: write-all
    steps:
      - uses: actions/checkout@v3
      - uses: ./.github/actions/remove-snapshot

  #  gradle-qa-build:
  #    needs: remove-snapshot
  #    runs-on: self-hosted
  #    steps:
  #      - uses: actions/checkout@v3
  #      - uses: ./.github/actions/setup
  #
  #      - run: |
  #          ./gradlew clean build createAirGapZip createAirGapZipWithoutDocker artifactoryPublish publishAirGapZip publishAirGapZipWithoutDocker -Pqabuild=true -PartifactoryRepo=bds-integrations-test --refresh-dependencies --stacktrace --info

  archive:
    runs-on: ubuntu-latest
    permissions: write-all
    steps:
      - uses: actions/upload-artifact@v3
        with:
          retention-days: 1

  next-snapshot:
    needs: remove-snapshot
    runs-on: [ self-hosted, linux ]
    permissions: write-all
    steps:
      - uses: actions/checkout@v3
      - uses: ./.github/actions/next-snapshot
